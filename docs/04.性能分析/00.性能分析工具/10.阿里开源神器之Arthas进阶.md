---
title: 阿里开源神器之Arthas进阶
date: 2022-07-08 13:24:05
permalink: /pages/4e4d50/
categories:
  - 性能分析
  - 性能分析工具
tags:
  - 性能优化
author: 
  name: Mr.Fire
  link: https://github.com/FireHH
---

### 1.help
查看帮助
![](https://cdn.jsdelivr.net/gh/FireHH/github_img_repository/arthas/help.png)

### 2.dashboard
**功能** 

监控面板，可查看cpu，线程，jvm内存，GC，系统等信息

**用法**
```shell script
dashboard -i 5000 -n 5
```
- i ：刷新频率，默认5000ms
- n ：刷新次数

**案例**
![](https://cdn.jsdelivr.net/gh/FireHH/github_img_repository/arthas/dashboard.png)

### 2. thread
**功能** 

查看当前线程信息，查看堆栈

**用法**
```shell script
thread -n 2  -i 100
```
- id ：工具id查看线程
- n ：指定最忙的前n个线程并打印堆栈
- b ：找到阻塞其他线程的线程
- i ：cpu使用率的采样间隔，默认200ms

**案例**

1)查看最忙的线程

![](https://cdn.jsdelivr.net/gh/FireHH/github_img_repository/arthas/thread.png)

2)查看死锁

![](https://cdn.jsdelivr.net/gh/FireHH/github_img_repository/arthas/deadlock.png)
::: warning 注意
目前只支持找出synchronized关键字阻塞住的线程， 如果是java.util.concurrent.Lock， 目前还不支持。
:::

3)根据线程状态过滤
![](https://cdn.jsdelivr.net/gh/FireHH/github_img_repository/arthas/thread-state.png)

### 3.trace

**功能** 

跟踪方法执行耗时，方法内部调用路径，渲染和统计整个调用链路上的所有性能开销和追踪调用链路，并输出方法路径上的每个节点上耗时。

**用法**

```
trace com.fire.arthas.demo.web.ArthasTestController trace  -n 5 --skipJDKMethod false 
```
- n ：执行追踪次数

很多时候我们只想看到某个方法的rt大于某个时间之后的trace结果，现在Arthas可以按照方法执行的耗时来进行过滤了，例如：
```
trace *StringUtils isBlank '#cost>100'  只展示执行耗时大于100ms的
```

表示当执行时间超过100ms的时候，才会输出trace的结果。
- **案例**
```
trace com.jiuqi.nr.jtable.params.base.DecimalLinkData getFormatData  -n 5 --skipJDKMethod false 
```
![avatar][案例1]

### 4.watch
### 4.sc

### 5.jad