(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{487:function(s,a,t){"use strict";t.r(a);var e=t(11),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"帮助及监控面板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助及监控面板"}},[s._v("#")]),s._v(" 帮助及监控面板")]),s._v(" "),a("h3",{attrs:{id:"_1-help"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-help"}},[s._v("#")]),s._v(" 1.help")]),s._v(" "),a("p",[s._v("查看帮助\n"),a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/help.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_2-dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-dashboard"}},[s._v("#")]),s._v(" 2.dashboard")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("监控面板，可查看cpu，线程，jvm内存，GC，系统等信息")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("dashboard "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("i ：刷新频率，默认5000ms")]),s._v(" "),a("li",[s._v("n ：刷新次数")])]),s._v(" "),a("p",[a("strong",[s._v("案例")]),s._v(" "),a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/dashboard.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"方法执行监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法执行监控"}},[s._v("#")]),s._v(" 方法执行监控")]),s._v(" "),a("p",[s._v("主要介绍trace，watch，montor，stack这几个命令的使用。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("这些命令，都通过字节码增强技术来实现的，会在指定类的方法中插入一些切面来实现数据统计和观测，因此在线上、预发使用时，\n请尽量明确需要观测的类、方法以及条件，诊断结束要执行 stop 或将增强过的类执行 reset 命令。")])]),s._v(" "),a("h3",{attrs:{id:"_1-trace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-trace"}},[s._v("#")]),s._v(" 1.trace")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("跟踪方法执行耗时，方法内部调用路径，渲染和统计整个调用链路上的所有性能开销和追踪调用链路，并输出方法路径上的每个节点上耗时。")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("trace com.fire.arthas.demo.web.ArthasTestController method  -n 5 --skipJDKMethod false \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("n ：执行追踪次数")]),s._v(" "),a("li",[s._v("skipJDKMethod：包含jdk里面的函数")])]),s._v(" "),a("p",[s._v("很多时候我们只想看到某个方法的rt大于某个时间之后的trace结果，现在Arthas可以按照方法执行的耗时来进行过滤了，例如：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("trace *StringUtils isBlank '#cost>100'  只展示执行耗时大于100ms的\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("#cost：方法执行耗时")])]),s._v(" "),a("p",[s._v("表示当执行时间超过100ms的时候，才会输出trace的结果。")]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("执行如下命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("trace com.fire.arthas.demo.web.ArthasTestController traceMethod  -n 5 --skipJDKMethod false \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/trace4.png",alt:""}})]),s._v(" "),a("p",[s._v("从图中可以看到方法调用栈执行耗时，从而分析具体哪块有性能问题。")]),s._v(" "),a("h3",{attrs:{id:"_2-watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-watch"}},[s._v("#")]),s._v(" 2.watch")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("让你能方便的观察到指定函数的调用情况。能观察到的范围为：返回值、抛出异常、入参，支持OGNL表达式")]),s._v(" "),a("p",[s._v("OGNL表达式官网："),a("a",{attrs:{href:"https://commons.apache.org/proper/commons-ognl/language-guide.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://commons.apache.org/proper/commons-ognl/language-guide.html"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("特别说明：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("watch 命令定义了4个观察事件点，即 -b 方法调用前，-e 方法异常后，-s 方法返回后，-f 方法结束后， -b、-e、-s 默认关闭，-f 默认打开，当指定观察点被打开后，在相应事件点会对观察表达式进行求值并输出")])]),s._v(" "),a("li",[a("p",[s._v("当使用 -b 时，由于观察事件点是在方法调用前，此时返回值或异常均不存在")])]),s._v(" "),a("li",[a("p",[s._v("在watch命令的结果里，会打印出location信息。location有三种可能值：AtEnter，AtExit，AtExceptionExit。对应方法入口，方法正常return，方法抛出异常。")])])]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("watch com.fire.arthas.demo.web.ArthasTestController watchMethod '{params,returnObj,throwExp}'  -n 2  -x 3 -s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("express ： 观察表达式，默认值：{params, target, returnObj} ，分别代表参数，目标，返回值")]),s._v(" "),a("li",[s._v("n ：监控次数")]),s._v(" "),a("li",[s._v("x ：指定输出结果的属性遍历深度，默认为 1，最大值是4")]),s._v(" "),a("li",[s._v("b ：观察方法调用前")]),s._v(" "),a("li",[s._v("e ：观察方法异常后")]),s._v(" "),a("li",[s._v("s ：观察方法返回后")]),s._v(" "),a("li",[s._v("f ：观察方法结束后")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("watch")]),s._v(" com.fire.arthas.demo.web.ArthasTestController watchMethod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{params,returnObj,throwExp}'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("1）异常的情况")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/watch-exception.png",alt:""}})]),s._v(" "),a("p",[s._v("2）正常输出")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/watch.png",alt:""}})]),s._v(" "),a("p",[s._v("3）调整输出遍历深度，观察参数的属性值，当前对象中的属性")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/static-map.png",alt:""}})]),s._v(" "),a("p",[s._v("执行如下命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("watch")]),s._v(" com.fire.arthas.demo.web.ArthasTestController watchMethod "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/watch-x.png",alt:""}})]),s._v(" "),a("p",[s._v("可以看到当前对象中TestService内部的cahce这map的值，如果x设置为4的话则只能看到上一层。")]),s._v(" "),a("h3",{attrs:{id:"_3-monitor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-monitor"}},[s._v("#")]),s._v(" 3.monitor")]),s._v(" "),a("p",[a("strong",[s._v("功能")]),s._v("\n对方法执行监控，可监控方法执行的成功失败次数，平均RT，失败率等。非实时返回命令。")]),s._v(" "),a("p",[s._v("监控维度：")]),s._v(" "),a("ul",[a("li",[s._v("timestamp\t  ： 时间戳")]),s._v(" "),a("li",[s._v("class\t      ： Java类")]),s._v(" "),a("li",[s._v("method\t  ： 方法（构造方法、普通方法）")]),s._v(" "),a("li",[s._v("total\t      ： 调用次数")]),s._v(" "),a("li",[s._v("success\t  ： 成功次数")]),s._v(" "),a("li",[s._v("fail\t      ： 失败次数")]),s._v(" "),a("li",[s._v("rt\t      ： 平均RT")]),s._v(" "),a("li",[s._v("fail-rate\t  ： 失败率")])]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("monitor com.fire.arthas.demo.service.TestService montorMethod  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cycle")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("n ：监控次数")]),s._v(" "),a("li",[s._v("cycle 监控周期，单位为秒，10代表10秒，也可简写为-c")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("本案例demo中montorMethod方法代码:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/monitor"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("monitorMethod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            testService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("montorMethod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"调用失败！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("montorMethod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RuntimeException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("执行如下命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("monitor com.fire.arthas.demo.service.TestService montorMethod  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cycle")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/montor.png",alt:""}})]),s._v(" "),a("p",[s._v("从图中可开出方法montorMethod执行15次，成功12次，失败3次，失败比例20%，平均RT为0.04ms。")]),s._v(" "),a("h3",{attrs:{id:"_4-stack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-stack"}},[s._v("#")]),s._v(" 4.stack")]),s._v(" "),a("p",[a("strong",[s._v("功能")]),s._v("\n输出当前方法被调用的调用路径，找到调用根源。")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("stack com.fire.arthas.demo.service.TestService traceMethod4  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("n ：执行次数")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("执行如下命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("stack com.fire.arthas.demo.service.TestService traceMethod4  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出TestService.traceMethod4方法的调用栈")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/stack.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"jvm相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm相关"}},[s._v("#")]),s._v(" JVM相关")]),s._v(" "),a("h3",{attrs:{id:"_1-thread"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-thread"}},[s._v("#")]),s._v(" 1. thread")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("查看当前线程信息，查看堆栈")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("thread "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("id ：工具id查看线程")]),s._v(" "),a("li",[s._v("n ：指定最忙的前n个线程并打印堆栈")]),s._v(" "),a("li",[s._v("b ：找到阻塞其他线程的线程")]),s._v(" "),a("li",[s._v("i ：cpu使用率的采样间隔，默认200ms")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("1)查看最忙的线程")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/thread.png",alt:""}})]),s._v(" "),a("p",[s._v("2)查看死锁")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/deadlock.png",alt:""}})]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("目前只支持找出synchronized关键字阻塞住的线程， 如果是java.util.concurrent.Lock， 目前还不支持。")])]),s._v(" "),a("p",[s._v("3)根据线程状态过滤\n"),a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/thread-state.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_2-jvm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-jvm"}},[s._v("#")]),s._v(" 2.jvm")]),s._v(" "),a("p",[a("strong",[s._v("功能")]),s._v("\n查看当前JVM信息，主要包括虚拟机相关信息、加载类数量、垃圾回收、内存、操作系统、线程等信息")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("jvm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/jvm.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_3-heapdump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-heapdump"}},[s._v("#")]),s._v(" 3.heapdump")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("转存储堆dump，类似jmap命令的heap dump功能。")]),s._v(" "),a("p",[s._v("jmap使用：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("jmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-dump:format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b,file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dump.txt pid\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(" heapdump /tmp/arthas/arthas-demo.hprof\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("执行如下命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("heapdump f:/arthas/arthas-demo.hprof\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/heapdump.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_4-logger"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-logger"}},[s._v("#")]),s._v(" 4.logger")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("查看logger信息，更新日志级别")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("p",[s._v("查看")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("logger\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("更新")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("logger "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" ROOT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--level")]),s._v(" debug\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("name  ：日志名称，对应Loggers里面的loggerName")]),s._v(" "),a("li",[s._v("level ：日志级别")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("本案例demo中的的logger配置")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v("    ...\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("Root")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("level")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("AppenderRef")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("Console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("Root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("Logger")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("level")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("com.fire.arthas.demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("AppenderRef")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("Console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("Logger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    ...\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/logger"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("loggerMethod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"进入logger方法！,参数name："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasLength")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"获取到参数name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("concat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_sutifix"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"获取到参数为空,返回错误!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("此时访问"),a("a",{attrs:{href:"localhost:8081/test/logger"}},[s._v("localhost:8081/test/logger")]),s._v(" 无日志输出")]),s._v(" "),a("ol",[a("li",[s._v("查看logger信息")])]),s._v(" "),a("p",[s._v("执行如下命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("logger\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/logger.png",alt:""}})]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("修改日志级别")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("logger "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" com.fire.arthas.demo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--level")]),s._v(" debug\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/logger2.png",alt:""}})]),s._v(" "),a("p",[s._v("再次请求，控制台输出了日志信息")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/logger3.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"字节码反编译相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字节码反编译相关"}},[s._v("#")]),s._v(" 字节码反编译相关")]),s._v(" "),a("h3",{attrs:{id:"_1-sc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-sc"}},[s._v("#")]),s._v(" 1.sc")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("查看JVM已加载的类信息")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sc "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("  com.fire.arthas.demo.ArthasDemeApplication "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("d ：输出当前类的详细信息，包括这个类所加载的原始文件来源、类的声明、加载的ClassLoader等详细信息。 如果一个类被多个ClassLoader所加载，则会出现多次")]),s._v(" "),a("li",[s._v("f ：输出该类的所有成员变量")]),s._v(" "),a("li",[s._v("x ：输出静态变量时的深度，默认为0")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sc "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("  com.fire.arthas.service.TestService "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/sc.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_2-sm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-sm"}},[s._v("#")]),s._v(" 2.sm")]),s._v(" "),a("p",[a("strong",[s._v("功能")]),s._v("\n查看已加载类的方法信息")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sm "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("  com.fire.arthas.demo.service.TestService *\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("d ：展示方法详细详细")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/sm.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_3-jad"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-jad"}},[s._v("#")]),s._v(" 3.jad")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("反编译指定已加载类的源码")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("jad --source-only  com.fire.arthas.demo.ArthasDemeApplication "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" 5556b35d\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("source-only：不带classLoader信息")]),s._v(" "),a("li",[s._v("c ：指定classLoader，当类被多个类加载的时候需要指定")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/jad.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_4-mc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-mc"}},[s._v("#")]),s._v(" 4.mc")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("内存编译器，编译java代码")]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /tmp/output /tmp/ClassA.java /tmp/ClassB.java\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("d ：指定输出目录")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("比如线上有个问题，始终没找到问题出在哪，这个时候我想打印一些日志来协助排查问题")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("jad --source-only  com.fire.arthas.demo.web.ArthasTestController "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/local/arthas/ArthasTestController.java\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("修改完成之后，用mc编译，但是不一定成功")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" /usr/local/arthas/ArthasTestController.java "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /usr/local/arthas/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_5-retransform"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-retransform"}},[s._v("#")]),s._v(" 5.retransform")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("加载外部的.class文件，retransform jvm已加载的类。")]),s._v(" "),a("ul",[a("li",[s._v("不允许新增加field/method")]),s._v(" "),a("li",[s._v("正在跑的函数，没有退出不能生效")])]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("retransform ArthasTestController.class\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("ol",[a("li",[s._v("jad命令反编译，修改代码")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("jad --source-only  com.fire.arthas.demo.web.ArthasTestController "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/local/software/arthas/jad/ArthasTestController.java\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("mc命令来内存编译修改过的代码")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" /usr/local/software/arthas/jad/ArthasTestController.java "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /usr/local/software/arthas/jad/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("用retransform命令加载新的字节码")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("retransform /usr/local/software/arthas/jad/ArthasTestController.class\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/retransform.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_6-redefine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-redefine"}},[s._v("#")]),s._v(" 6.redefine")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("加载外部的.class文件，redefine jvm已加载的类。")]),s._v(" "),a("ul",[a("li",[s._v("不能修改、添加、删除类的field和method")]),s._v(" "),a("li",[s._v("和watch/trace/jad/tt等命令冲突")]),s._v(" "),a("li",[s._v("reset命令对redefine的类无效")]),s._v(" "),a("li",[s._v("正在跑的函数，没有退出不能生效")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("redefine后的原来的类不能恢复，redefine有可能失败（比如增加了新的field），参考jdk本身的文档。")])]),s._v(" "),a("p",[a("strong",[s._v("用法")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("redefine ArthasTestController.class\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("和retransform类似")]),s._v(" "),a("h2",{attrs:{id:"火焰图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#火焰图"}},[s._v("#")]),s._v(" 火焰图")]),s._v(" "),a("p",[s._v("1.profiler")]),s._v(" "),a("p",[a("strong",[s._v("功能")])]),s._v(" "),a("p",[s._v("生成应用热点的火焰图。本质上是通过不断的采样，然后把收集到的采样结果生成火焰图。")]),s._v(" "),a("p",[a("strong",[s._v("用法")]),s._v("\n启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("profiler start "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--event")]),s._v(" cpu "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("event ： 采样事件 ，支持cpu 、alloc 、lock 、wall 、itimer等")]),s._v(" "),a("li",[s._v("d ： 采样时间\n采样并输出")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("profiler stop "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--format")]),s._v(" html\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或者")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("profiler stop "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--file")]),s._v(" /usr/local/profiler.html\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("format ： 输出格式")]),s._v(" "),a("li",[s._v("file ：输出文件")])]),s._v(" "),a("p",[a("strong",[s._v("案例")])]),s._v(" "),a("p",[s._v("默认情况下采样后访问 "),a("a",{attrs:{href:"http://localhost:3658/arthas-output/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:3658/arthas-output/"),a("OutboundLink")],1),s._v(" 可以看到采样结果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/arthas/profiler.png",alt:""}})]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("参考："),a("a",{attrs:{href:"https://arthas.aliyun.com/doc/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://arthas.aliyun.com/doc/"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("案例源码："),a("a",{attrs:{href:"https://gitee.com/firegitspace/arthas-demo.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://gitee.com/firegitspace/arthas-demo.git"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("在线教程："),a("a",{attrs:{href:"https://start.aliyun.com/handson-lab?category=arthas",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://start.aliyun.com/handson-lab?category=arthas"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);