(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{519:function(s,t,a){"use strict";a.r(t);var n=a(11),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#synchronized-å’Œ-reentrantlock-æ˜¯å¦‚ä½•å®ç°çš„-å®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«"}},[s._v("synchronized å’Œ ReentrantLock æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")])]),t("li",[t("a",{attrs:{href:"#è€ƒç‚¹åˆ†æ"}},[s._v("è€ƒç‚¹åˆ†æ")])]),t("li",[t("a",{attrs:{href:"#çŸ¥è¯†æ‰©å±•"}},[s._v("çŸ¥è¯†æ‰©å±•")]),t("ul",[t("li",[t("a",{attrs:{href:"#reentrantlock-æºç åˆ†æ"}},[s._v("ReentrantLock æºç åˆ†æ")])])])]),t("li",[t("a",{attrs:{href:"#jdk-1-6-é”ä¼˜åŒ–"}},[s._v("JDK 1.6 é”ä¼˜åŒ–")]),t("ul",[t("li",[t("a",{attrs:{href:"#è‡ªé€‚åº”è‡ªæ—‹é”"}},[s._v("è‡ªé€‚åº”è‡ªæ—‹é”")])]),t("li",[t("a",{attrs:{href:"#é”å‡çº§"}},[s._v("é”å‡çº§")])])])]),t("li",[t("a",{attrs:{href:"#æ€»ç»“"}},[s._v("æ€»ç»“")])])])]),t("p"),s._v(" "),t("h2",{attrs:{id:"synchronized-å’Œ-reentrantlock-æ˜¯å¦‚ä½•å®ç°çš„-å®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#synchronized-å’Œ-reentrantlock-æ˜¯å¦‚ä½•å®ç°çš„-å®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«"}},[s._v("#")]),s._v(" synchronized å’Œ ReentrantLock æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")]),s._v(" "),t("p",[s._v("åœ¨ JDK 1.5 ä¹‹å‰å…±äº«å¯¹è±¡çš„åè°ƒæœºåˆ¶åªæœ‰ "),t("code",[s._v("synchronized")]),s._v(" å’Œ "),t("code",[s._v("volatile")]),s._v("ï¼Œåœ¨ JDK 1.5 ä¸­å¢åŠ äº†æ–°çš„æœºåˆ¶ "),t("code",[s._v("ReentrantLock")]),s._v("ï¼Œè¯¥æœºåˆ¶çš„è¯ç”Ÿå¹¶ä¸æ˜¯ä¸ºäº†æ›¿ä»£ "),t("code",[s._v("synchronized")]),s._v("ï¼Œè€Œæ˜¯åœ¨ "),t("code",[s._v("synchronized")]),s._v(" ä¸é€‚ç”¨çš„æƒ…å†µä¸‹ï¼Œæä¾›ä¸€ç§å¯ä»¥é€‰æ‹©çš„é«˜çº§åŠŸèƒ½ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("å…¸å‹å›ç­”")])]),s._v(" "),t("p",[t("code",[s._v("synchronized")]),s._v(" å±äºç‹¬å å¼æ‚²è§‚é”ï¼Œæ˜¯é€šè¿‡ JVM éšå¼å®ç°çš„ï¼Œ"),t("code",[s._v("synchronized")]),s._v(" åªå…è®¸åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œèµ„æºã€‚")]),s._v(" "),t("p",[s._v("åœ¨ Java ä¸­æ¯ä¸ªå¯¹è±¡éƒ½éšå¼åŒ…å«ä¸€ä¸ª monitorï¼ˆç›‘è§†å™¨ï¼‰å¯¹è±¡ï¼ŒåŠ é”çš„è¿‡ç¨‹å…¶å®å°±æ˜¯ç«äº‰ monitor çš„è¿‡ç¨‹ï¼Œå½“çº¿ç¨‹è¿›å…¥å­—èŠ‚ç  monitorenter æŒ‡ä»¤ä¹‹åï¼Œçº¿ç¨‹å°†æŒæœ‰ monitor å¯¹è±¡ï¼Œæ‰§è¡Œ monitorexit æ—¶é‡Šæ”¾ monitor å¯¹è±¡ï¼Œå½“å…¶ä»–çº¿ç¨‹æ²¡æœ‰æ‹¿åˆ° monitor å¯¹è±¡æ—¶ï¼Œåˆ™éœ€è¦é˜»å¡ç­‰å¾…è·å–è¯¥å¯¹è±¡ã€‚")]),s._v(" "),t("p",[t("code",[s._v("ReentrantLock")]),s._v(" æ˜¯ Lock çš„é»˜è®¤å®ç°æ–¹å¼ä¹‹ä¸€ï¼Œå®ƒæ˜¯åŸºäº "),t("code",[s._v("AQS")]),s._v("ï¼ˆAbstract Queued Synchronizerï¼Œé˜Ÿåˆ—åŒæ­¥å™¨ï¼‰å®ç°çš„ï¼Œå®ƒé»˜è®¤æ˜¯é€šè¿‡éå…¬å¹³é”å®ç°çš„ï¼Œåœ¨å®ƒçš„å†…éƒ¨æœ‰ä¸€ä¸ª "),t("code",[s._v("state")]),s._v(" çš„çŠ¶æ€å­—æ®µç”¨äºè¡¨ç¤ºé”æ˜¯å¦è¢«å ç”¨ï¼Œå¦‚æœæ˜¯ 0 åˆ™è¡¨ç¤ºé”æœªè¢«å ç”¨ï¼Œæ­¤æ—¶çº¿ç¨‹å°±å¯ä»¥æŠŠ "),t("code",[s._v("state")]),s._v(" æ”¹ä¸º 1ï¼Œå¹¶æˆåŠŸè·å¾—é”ï¼Œè€Œå…¶ä»–æœªè·å¾—é”çš„çº¿ç¨‹åªèƒ½å»æ’é˜Ÿç­‰å¾…è·å–é”èµ„æºã€‚")]),s._v(" "),t("p",[t("code",[s._v("synchronized")]),s._v(" å’Œ "),t("code",[s._v("ReentrantLock")]),s._v(" éƒ½æä¾›äº†é”çš„åŠŸèƒ½ï¼Œå…·å¤‡äº’æ–¥æ€§å’Œä¸å¯è§æ€§ã€‚åœ¨ JDK 1.5 ä¸­ "),t("code",[s._v("synchronized")]),s._v(" çš„æ€§èƒ½è¿œè¿œä½äº  "),t("code",[s._v("ReentrantLock")]),s._v("ï¼Œä½†åœ¨ JDK 1.6 ä¹‹å  "),t("code",[s._v("synchronized")]),s._v(" çš„æ€§èƒ½ç•¥ä½äº "),t("code",[s._v("ReentrantLock")]),s._v("ï¼Œå®ƒçš„åŒºåˆ«å¦‚ä¸‹ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("synchronized æ˜¯ JVM éšå¼å®ç°çš„ï¼Œè€Œ ReentrantLock æ˜¯ Java è¯­è¨€æä¾›çš„ APIï¼›")]),s._v(" "),t("li",[s._v("ReentrantLock å¯è®¾ç½®ä¸ºå…¬å¹³é”ï¼Œè€Œ synchronized å´ä¸è¡Œï¼›")]),s._v(" "),t("li",[s._v("ReentrantLock åªèƒ½ä¿®é¥°ä»£ç å—ï¼Œè€Œ synchronized å¯ä»¥ç”¨äºä¿®é¥°æ–¹æ³•ã€ä¿®é¥°ä»£ç å—ç­‰ï¼›")]),s._v(" "),t("li",[s._v("ReentrantLock éœ€è¦æ‰‹åŠ¨åŠ é”å’Œé‡Šæ”¾é”ï¼Œå¦‚æœå¿˜è®°é‡Šæ”¾é”ï¼Œåˆ™ä¼šé€ æˆèµ„æºè¢«æ°¸ä¹…å ç”¨ï¼Œè€Œ synchronized æ— éœ€æ‰‹åŠ¨é‡Šæ”¾é”ï¼›")]),s._v(" "),t("li",[s._v("ReentrantLock å¯ä»¥çŸ¥é“æ˜¯å¦æˆåŠŸè·å¾—äº†é”ï¼Œè€Œ synchronized  å´ä¸è¡Œã€‚")])]),s._v(" "),t("h2",{attrs:{id:"è€ƒç‚¹åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è€ƒç‚¹åˆ†æ"}},[s._v("#")]),s._v(" è€ƒç‚¹åˆ†æ")]),s._v(" "),t("p",[t("code",[s._v("synchronized")]),s._v(" å’Œ "),t("code",[s._v("ReentrantLock")]),s._v(" æ˜¯æ¯”çº¿ç¨‹æ± è¿˜è¦é«˜é¢‘çš„é¢è¯•é—®é¢˜ï¼Œå› ä¸ºå®ƒåŒ…å«äº†æ›´å¤šçš„çŸ¥è¯†ç‚¹ï¼Œä¸”æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æ›´åŠ æ·±å…¥ï¼Œå¯¹é¢è¯•è€…çš„è¦æ±‚ä¹Ÿæ›´é«˜ï¼Œå‰é¢æˆ‘ä»¬ç®€è¦åœ°ä»‹ç»äº† "),t("code",[s._v("synchronized")]),s._v(" å’Œ "),t("code",[s._v("ReentrantLock")]),s._v(" çš„æ¦‚å¿µåŠæ‰§è¡ŒåŸç†ï¼Œä½†å¾ˆå¤šå¤§å‚ä¼šæ›´åŠ æ·±å…¥çš„è¿½é—®æ›´å¤šå…³äºå®ƒä»¬çš„å®ç°ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ReentrantLock çš„å…·ä½“å®ç°ç»†èŠ‚æ˜¯ä»€ä¹ˆï¼Ÿ")]),s._v(" "),t("li",[s._v("JDK 1.6 æ—¶é”åšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ")])]),s._v(" "),t("h2",{attrs:{id:"çŸ¥è¯†æ‰©å±•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#çŸ¥è¯†æ‰©å±•"}},[s._v("#")]),s._v(" çŸ¥è¯†æ‰©å±•")]),s._v(" "),t("h3",{attrs:{id:"reentrantlock-æºç åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reentrantlock-æºç åˆ†æ"}},[s._v("#")]),s._v(" ReentrantLock æºç åˆ†æ")]),s._v(" "),t("p",[s._v("ä»æºç å‡ºå‘æ¥è§£å¯† "),t("code",[s._v("ReentrantLock")]),s._v(" çš„å…·ä½“å®ç°ç»†èŠ‚ï¼Œé¦–å…ˆæ¥çœ‹ "),t("code",[s._v("ReentrantLock")]),s._v(" çš„ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    sync "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NonfairSync")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// éå…¬å¹³é”")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" fair"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    sync "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fair "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FairSync")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NonfairSync")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("æ— å‚çš„æ„é€ å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªéå…¬å¹³é”ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥æ ¹æ®ç¬¬äºŒä¸ªæ„é€ å‡½æ•°ï¼Œè®¾ç½®ä¸€ä¸ª boolean ç±»å‹çš„å€¼ï¼Œæ¥å†³å®šæ˜¯å¦ä½¿ç”¨å…¬å¹³é”æ¥å®ç°çº¿ç¨‹çš„è°ƒåº¦ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("å…¬å¹³é” VS éå…¬å¹³é”")])]),s._v(" "),t("p",[s._v("å…¬å¹³é”çš„å«ä¹‰æ˜¯çº¿ç¨‹éœ€è¦æŒ‰ç…§è¯·æ±‚çš„é¡ºåºæ¥è·å¾—é”ï¼›è€Œéå…¬å¹³é”åˆ™å…è®¸â€œæ’é˜Ÿâ€çš„æƒ…å†µå­˜åœ¨ï¼Œæ‰€è°“çš„â€œæ’é˜Ÿâ€æŒ‡çš„æ˜¯ï¼Œçº¿ç¨‹åœ¨å‘é€è¯·æ±‚çš„åŒæ—¶è¯¥é”çš„çŠ¶æ€æ°å¥½å˜æˆäº†å¯ç”¨ï¼Œé‚£ä¹ˆæ­¤çº¿ç¨‹å°±å¯ä»¥è·³è¿‡é˜Ÿåˆ—ä¸­æ‰€æœ‰æ’é˜Ÿçš„çº¿ç¨‹ç›´æ¥æ‹¥æœ‰è¯¥é”ã€‚")]),s._v(" "),t("p",[s._v("è€Œå…¬å¹³é”ç”±äºæœ‰æŒ‚èµ·å’Œæ¢å¤æ‰€ä»¥å­˜åœ¨ä¸€å®šçš„å¼€é”€ï¼Œå› æ­¤æ€§èƒ½ä¸å¦‚éå…¬å¹³é”ï¼Œæ‰€ä»¥ "),t("code",[s._v("ReentrantLock")]),s._v(" å’Œ "),t("code",[s._v("synchronized")]),s._v(" é»˜è®¤éƒ½æ˜¯éå…¬å¹³é”çš„å®ç°æ–¹å¼ã€‚")]),s._v(" "),t("p",[t("code",[s._v("ReentrantLock")]),s._v(" æ˜¯é€šè¿‡ "),t("code",[s._v("lock()")]),s._v(" æ¥è·å–é”ï¼Œå¹¶é€šè¿‡ "),t("code",[s._v("unlock()")]),s._v(" é‡Šæ”¾é”ï¼Œä½¿ç”¨ä»£ç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lock")]),s._v(" lock "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŠ é”")]),s._v("\n    lock"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//......ä¸šåŠ¡å¤„ç†")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é‡Šæ”¾é”")]),s._v("\n    lock"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("ReentrantLock ä¸­çš„ "),t("code",[s._v("lock()")]),s._v(" æ˜¯é€šè¿‡ "),t("code",[s._v("sync.lock()")]),s._v(" å®ç°çš„ï¼Œä½† Sync ç±»ä¸­çš„ "),t("code",[s._v("lock()")]),s._v(" æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéœ€è¦å­ç±» NonfairSync æˆ– FairSync å»å®ç°ï¼ŒNonfairSync ä¸­çš„ "),t("code",[s._v("lock()")]),s._v(" æºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("compareAndSetState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºæ­¤é”çš„æŒæœ‰è€…")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setExclusiveOwnerThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("acquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("FairSync ä¸­çš„ "),t("code",[s._v("lock()")]),s._v(" æºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("acquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("å¯ä»¥çœ‹å‡ºéå…¬å¹³é”æ¯”å…¬å¹³é”åªæ˜¯å¤šäº†ä¸€è¡Œ "),t("code",[s._v("compareAndSetState")]),s._v(" æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯å°è¯•å°† "),t("code",[s._v("state")]),s._v(" å€¼ç”± 0 ç½®æ¢ä¸º 1ï¼Œå¦‚æœè®¾ç½®æˆåŠŸçš„è¯ï¼Œåˆ™è¯´æ˜å½“å‰æ²¡æœ‰å…¶ä»–çº¿ç¨‹æŒæœ‰è¯¥é”ï¼Œä¸ç”¨å†å»æ’é˜Ÿäº†ï¼Œå¯ç›´æ¥å ç”¨è¯¥é”ï¼Œå¦åˆ™ï¼Œåˆ™éœ€è¦é€šè¿‡ "),t("code",[s._v("acquire")]),s._v(" æ–¹æ³•å»æ’é˜Ÿã€‚")]),s._v(" "),t("p",[t("code",[s._v("acquire")]),s._v(" æºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("acquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tryAcquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("acquireQueued")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addWaiter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXCLUSIVE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("selfInterrupt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("code",[s._v("tryAcquire")]),s._v(" æ–¹æ³•å°è¯•è·å–é”ï¼Œå¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™æŠŠå®ƒåŠ å…¥åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œæ¥çœ‹ "),t("code",[s._v("tryAcquire")]),s._v(" çš„æºç ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tryAcquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" acquires"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" current "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å…¬å¹³é”æ¯”éå…¬å¹³é”å¤šäº†ä¸€è¡Œä»£ç  !hasQueuedPredecessors() ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasQueuedPredecessors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("compareAndSetState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" acquires"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//å°è¯•è·å–é”")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setExclusiveOwnerThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–æˆåŠŸï¼Œæ ‡è®°è¢«æŠ¢å ")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExclusiveOwnerThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" nextc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" acquires"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nextc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Error")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Maximum lock count exceeded"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nextc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// set state=state+1")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("å¯¹äºæ­¤æ–¹æ³•æ¥è¯´ï¼Œå…¬å¹³é”æ¯”éå…¬å¹³é”åªå¤šä¸€è¡Œä»£ç  "),t("code",[s._v("!hasQueuedPredecessors()")]),s._v("ï¼Œå®ƒç”¨æ¥æŸ¥çœ‹é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰æ¯”å®ƒç­‰å¾…æ—¶é—´æ›´ä¹…çš„çº¿ç¨‹ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±å°è¯•ä¸€ä¸‹æ˜¯å¦èƒ½è·å–åˆ°é”ï¼Œå¦‚æœè·å–æˆåŠŸï¼Œåˆ™æ ‡è®°ä¸ºå·²ç»è¢«å ç”¨ã€‚")]),s._v(" "),t("p",[s._v("å¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™è°ƒç”¨ "),t("code",[s._v("addWaiter")]),s._v(" æ–¹æ³•æŠŠçº¿ç¨‹åŒ…è£…æˆ Node å¯¹è±¡ï¼ŒåŒæ—¶æ”¾å…¥åˆ°é˜Ÿåˆ—ä¸­ï¼Œä½† "),t("code",[s._v("addWaiter")]),s._v(" æ–¹æ³•å¹¶ä¸ä¼šå°è¯•è·å–é”ï¼Œ"),t("code",[s._v("acquireQueued")]),s._v(" æ–¹æ³•æ‰ä¼šå°è¯•è·å–é”ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œåˆ™æ­¤èŠ‚ç‚¹ä¼šè¢«æŒ‚èµ·ï¼Œæºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¤±è´¥åˆ™ä¼šè¢«æŒ‚èµ·\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("acquireQueued")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" failed "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–é”æ˜¯å¦æˆåŠŸçš„çŠ¶æ€æ ‡è¯†")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" interrupted "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå‰é©±èŠ‚ç‚¹ï¼‰")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("predecessor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å½“å‰èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæœ‰æƒå°è¯•è·å–é”")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" head "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tryAcquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setHead")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–æˆåŠŸï¼Œå°†å½“å‰èŠ‚ç‚¹è®¾ç½®ä¸º head èŠ‚ç‚¹")]),s._v("\n                p"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŸ head èŠ‚ç‚¹å‡ºé˜Ÿï¼Œç­‰å¾…è¢« GC")]),s._v("\n                failed "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–æˆåŠŸ")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" interrupted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ¤æ–­è·å–é”å¤±è´¥åæ˜¯å¦å¯ä»¥æŒ‚èµ·")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shouldParkAfterFailedAcquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parkAndCheckInterrupt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// çº¿ç¨‹è‹¥è¢«ä¸­æ–­ï¼Œè¿”å› true")]),s._v("\n                interrupted "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("failed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cancelAcquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("p",[s._v("è¯¥æ–¹æ³•ä¼šä½¿ç”¨ for(;ğŸ˜‰ æ— é™å¾ªç¯çš„æ–¹å¼æ¥å°è¯•è·å–é”ï¼Œè‹¥è·å–å¤±è´¥ï¼Œåˆ™è°ƒç”¨ "),t("code",[s._v("shouldParkAfterFailedAcquire")]),s._v(" æ–¹æ³•ï¼Œå°è¯•æŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œæºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯ä»¥è¢«æŒ‚èµ·\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shouldParkAfterFailedAcquire")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" pred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å¾—å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ws "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("waitStatus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ä¸º SIGNALï¼Œå½“å‰çº¿ç¨‹å¯ä»¥è¢«æŒ‚èµ·ï¼ˆé˜»å¡ï¼‰")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ws "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SIGNAL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ws "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è‹¥å‰é©±èŠ‚ç‚¹çŠ¶æ€ä¸º CANCELLEDï¼Œé‚£å°±ä¸€ç›´å¾€å‰æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ­£å¸¸ç­‰å¾…çš„çŠ¶æ€ä¸ºæ­¢")]),s._v("\n            node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prev "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pred "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prev"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("waitStatus "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¹¶å°†å½“å‰èŠ‚ç‚¹æ’åœ¨å®ƒåè¾¹")]),s._v("\n        pred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("next "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŠŠå‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ä¿®æ”¹ä¸º SIGNAL")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("compareAndSetWaitStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ws"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SIGNAL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("çº¿ç¨‹å…¥åˆ—è¢«æŒ‚èµ·çš„å‰ææ¡ä»¶æ˜¯ï¼Œå‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ä¸º SIGNALï¼ŒSIGNAL çŠ¶æ€çš„å«ä¹‰æ˜¯åç»§èŠ‚ç‚¹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå½“å‰èŠ‚ç‚¹é‡Šæ”¾é”åå°†ä¼šå”¤é†’åç»§èŠ‚ç‚¹ã€‚æ‰€ä»¥åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œä¼šå…ˆåˆ¤æ–­å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå¦‚æœä¸º SIGNALï¼Œåˆ™å½“å‰çº¿ç¨‹å¯ä»¥è¢«æŒ‚èµ·å¹¶è¿”å› trueï¼›å¦‚æœå‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ >0ï¼Œåˆ™è¡¨ç¤ºå‰é©±èŠ‚ç‚¹å–æ¶ˆäº†ï¼Œè¿™æ—¶å€™éœ€è¦ä¸€ç›´å¾€å‰æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°æœ€è¿‘ä¸€ä¸ªæ­£å¸¸ç­‰å¾…çš„å‰é©±èŠ‚ç‚¹ï¼Œç„¶åæŠŠå®ƒä½œä¸ºè‡ªå·±çš„å‰é©±èŠ‚ç‚¹ï¼›å¦‚æœå‰é©±èŠ‚ç‚¹æ­£å¸¸ï¼ˆæœªå–æ¶ˆï¼‰ï¼Œåˆ™ä¿®æ”¹å‰é©±èŠ‚ç‚¹çŠ¶æ€ä¸º SIGNALã€‚")]),s._v(" "),t("p",[s._v("åˆ°è¿™é‡Œæ•´ä¸ªåŠ é”çš„æµç¨‹å°±å·²ç»èµ°å®Œäº†ï¼Œæœ€åçš„æƒ…å†µæ˜¯ï¼Œæ²¡æœ‰æ‹¿åˆ°é”çš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­è¢«æŒ‚èµ·ï¼Œç›´åˆ°æ‹¥æœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”ä¹‹åï¼Œæ‰ä¼šå»å”¤é†’å…¶ä»–çš„çº¿ç¨‹å»è·å–é”èµ„æºï¼Œæ•´ä¸ªè¿è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://fire-repository.oss-cn-beijing.aliyuncs.com/java-base/thread/sync.png",alt:""}})]),s._v(" "),t("p",[s._v("unlock ç›¸æ¯”äº lock æ¥è¯´å°±ç®€å•å¾ˆå¤šäº†ï¼Œæºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    sync"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("release")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("release")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°è¯•é‡Šæ”¾é”")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tryRelease")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é‡Šæ”¾æˆåŠŸ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" h "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" head"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("h "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("waitStatus "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unparkSuccessor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("é”çš„é‡Šæ”¾æµç¨‹ä¸ºï¼Œå…ˆè°ƒç”¨ "),t("code",[s._v("tryRelease")]),s._v(" æ–¹æ³•å°è¯•é‡Šæ”¾é”ï¼Œå¦‚æœé‡Šæ”¾æˆåŠŸï¼Œåˆ™æŸ¥çœ‹å¤´ç»“ç‚¹çš„çŠ¶æ€æ˜¯å¦ä¸º SIGNALï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å”¤é†’å¤´ç»“ç‚¹çš„ä¸‹ä¸ªèŠ‚ç‚¹å…³è”çš„çº¿ç¨‹ï¼›å¦‚æœé‡Šæ”¾é”å¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚")]),s._v(" "),t("p",[t("code",[s._v("tryRelease")]),s._v(" æºç å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * å°è¯•é‡Šæ”¾å½“å‰çº¿ç¨‹å æœ‰çš„é”\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tryRelease")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" releases"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" releases"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é‡Šæ”¾é”åçš„çŠ¶æ€ï¼Œ0 è¡¨ç¤ºé‡Šæ”¾é”æˆåŠŸ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¦‚æœæ‹¥æœ‰é”çš„çº¿ç¨‹ä¸æ˜¯å½“å‰çº¿ç¨‹çš„è¯æŠ›å‡ºå¼‚å¸¸")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExclusiveOwnerThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IllegalMonitorStateException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" free "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é”è¢«æˆåŠŸé‡Šæ”¾")]),s._v("\n        free "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setExclusiveOwnerThread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¸…ç©ºç‹¬å çº¿ç¨‹")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–° state å€¼ï¼Œ0 è¡¨ç¤ºä¸ºé‡Šæ”¾é”æˆåŠŸ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" free"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("åœ¨ "),t("code",[s._v("tryRelease")]),s._v(" æ–¹æ³•ä¸­ï¼Œä¼šå…ˆåˆ¤æ–­å½“å‰çš„çº¿ç¨‹æ˜¯ä¸æ˜¯å ç”¨é”çš„çº¿ç¨‹ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œåˆ™å…ˆè®¡ç®—é”çš„çŠ¶æ€å€¼ "),t("code",[s._v("getState() - releases")]),s._v(" æ˜¯å¦ä¸º 0ï¼Œå¦‚æœä¸º 0ï¼Œåˆ™è¡¨ç¤ºå¯ä»¥æ­£å¸¸çš„é‡Šæ”¾é”ï¼Œç„¶åæ¸…ç©ºç‹¬å çš„çº¿ç¨‹ï¼Œæœ€åä¼šæ›´æ–°é”çš„çŠ¶æ€å¹¶è¿”å›æ‰§è¡Œç»“æœã€‚")]),s._v(" "),t("h2",{attrs:{id:"jdk-1-6-é”ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jdk-1-6-é”ä¼˜åŒ–"}},[s._v("#")]),s._v(" JDK 1.6 é”ä¼˜åŒ–")]),s._v(" "),t("h3",{attrs:{id:"è‡ªé€‚åº”è‡ªæ—‹é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªé€‚åº”è‡ªæ—‹é”"}},[s._v("#")]),s._v(" è‡ªé€‚åº”è‡ªæ—‹é”")]),s._v(" "),t("p",[s._v("JDK 1.5 åœ¨å‡çº§ä¸º JDK 1.6 æ—¶ï¼ŒHotSpot è™šæ‹Ÿæœºå›¢é˜Ÿåœ¨é”çš„ä¼˜åŒ–ä¸Šä¸‹äº†å¾ˆå¤§åŠŸå¤«ï¼Œæ¯”å¦‚å®ç°äº†è‡ªé€‚åº”å¼è‡ªæ—‹é”ã€é”å‡çº§ç­‰ã€‚")]),s._v(" "),t("p",[s._v("JDK 1.6 å¼•å…¥äº†è‡ªé€‚åº”å¼è‡ªæ—‹é”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†æ˜¯å›ºå®šçš„æ—¶é—´äº†ï¼Œæ¯”å¦‚åœ¨åŒä¸€ä¸ªé”å¯¹è±¡ä¸Šï¼Œå¦‚æœé€šè¿‡è‡ªæ—‹ç­‰å¾…æˆåŠŸè·å–äº†é”ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºå°±ä¼šè®¤ä¸ºï¼Œå®ƒä¸‹ä¸€æ¬¡å¾ˆæœ‰å¯èƒ½ä¹Ÿä¼šæˆåŠŸ (é€šè¿‡è‡ªæ—‹è·å–åˆ°é”)ï¼Œå› æ­¤å…è®¸è‡ªæ—‹ç­‰å¾…çš„æ—¶é—´ä¼šç›¸å¯¹çš„æ¯”è¾ƒé•¿ï¼Œè€Œå½“æŸä¸ªé”é€šè¿‡è‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å¾—è¿‡é”ï¼Œé‚£ä¹ˆä»¥ååœ¨è·å–è¯¥é”æ—¶ï¼Œå¯èƒ½ä¼šç›´æ¥å¿½ç•¥æ‰è‡ªæ—‹çš„è¿‡ç¨‹ï¼Œä»¥é¿å…æµªè´¹ CPU çš„èµ„æºï¼Œè¿™å°±æ˜¯è‡ªé€‚åº”è‡ªæ—‹é”çš„åŠŸèƒ½ã€‚")]),s._v(" "),t("h3",{attrs:{id:"é”å‡çº§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é”å‡çº§"}},[s._v("#")]),s._v(" é”å‡çº§")]),s._v(" "),t("p",[s._v("é”å‡çº§å…¶å®å°±æ˜¯ä»åå‘é”åˆ°è½»é‡çº§é”å†åˆ°é‡é‡çº§é”å‡çº§çš„è¿‡ç¨‹ï¼Œè¿™æ˜¯ JDK 1.6 æä¾›çš„ä¼˜åŒ–åŠŸèƒ½ï¼Œä¹Ÿç§°ä¹‹ä¸ºé”è†¨èƒ€ã€‚")]),s._v(" "),t("p",[s._v("åå‘é”æ˜¯æŒ‡åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹è®¾ç½®çš„ä¸€ç§é”çŠ¶æ€ã€‚åå‘é”çš„æ„æ€æ˜¯å®ƒä¼šåå‘äºç¬¬ä¸€ä¸ªè·å–å®ƒçš„çº¿ç¨‹ï¼Œå½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«è·å–åˆ°ä¹‹åï¼Œä¼šåœ¨æ­¤å¯¹è±¡å¤´ä¸­è®¾ç½®æ ‡ç¤ºä¸ºâ€œ01â€ï¼Œè¡¨ç¤ºåå‘é”çš„æ¨¡å¼ï¼Œå¹¶ä¸”åœ¨å¯¹è±¡å¤´ä¸­è®°å½•æ­¤çº¿ç¨‹çš„ IDï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ˜¯æŒæœ‰åå‘é”çš„çº¿ç¨‹æ¯æ¬¡åœ¨è¿›å…¥çš„è¯ï¼Œä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œï¼Œå¦‚"),t("code",[s._v("Locking")]),s._v("ã€"),t("code",[s._v("Unlocking")]),s._v(" ç­‰ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–æ­¤é”çš„æ—¶å€™ï¼Œåå‘é”æ¨¡å¼æ‰ä¼šç»“æŸï¼Œåå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ã€‚ä½†å¦‚æœåœ¨å¤šæ•°é”æ€»ä¼šè¢«ä¸åŒçš„çº¿ç¨‹è®¿é—®æ—¶ï¼Œåå‘é”æ¨¡å¼å°±æ¯”è¾ƒå¤šä½™äº†ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ "),t("code",[s._v("-XX:-UseBiasedLocking")]),s._v(" æ¥ç¦ç”¨åå‘é”ä»¥æé«˜æ€§èƒ½ã€‚")]),s._v(" "),t("p",[s._v("è½»é‡é”æ˜¯ç›¸å¯¹äºé‡é‡é”è€Œè¨€çš„ï¼Œåœ¨ JDK 1.6 ä¹‹å‰ï¼Œ"),t("code",[s._v("synchronized")]),s._v(" æ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿçš„äº’æ–¥é‡ï¼ˆmutex lockï¼‰æ¥å®ç°çš„ï¼Œè¿™ç§å®ç°æ–¹å¼éœ€è¦åœ¨ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€ä¹‹é—´åšè½¬æ¢ï¼Œæœ‰å¾ˆå¤§çš„æ€§èƒ½æ¶ˆè€—ï¼Œè¿™ç§ä¼ ç»Ÿå®ç°é”çš„æ–¹å¼è¢«ç§°ä¹‹ä¸ºé‡é‡é”ã€‚")]),s._v(" "),t("p",[s._v("è€Œè½»é‡é”æ˜¯é€šè¿‡æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆ"),t("code",[s._v("CAS")]),s._v("ï¼ŒCompare and Swapï¼‰æ¥å®ç°çš„ï¼Œå®ƒå¯¹æ¯”çš„æ˜¯çº¿ç¨‹å’Œå¯¹è±¡çš„ Mark Wordï¼ˆå¯¹è±¡å¤´ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼‰ï¼Œå¦‚æœæ›´æ–°æˆåŠŸåˆ™è¡¨ç¤ºå½“å‰çº¿ç¨‹æˆåŠŸæ‹¥æœ‰æ­¤é”ï¼›å¦‚æœå¤±è´¥ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥å¯¹è±¡çš„ Mark Word æ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰æ­¤é”ï¼Œå¦åˆ™ï¼Œåˆ™è¯´æ˜æ­¤é”å·²ç»è¢«å…¶ä»–çº¿ç¨‹å ç”¨äº†ã€‚å½“ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹äº‰æŠ¢æ­¤é”æ—¶ï¼Œè½»é‡çº§é”å°±è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œè¿™å°±æ˜¯é”å‡çº§çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ JDK 1.6 é”ä¼˜åŒ–çš„å†…å®¹ã€‚")]),s._v(" "),t("h2",{attrs:{id:"æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[s._v("#")]),s._v(" æ€»ç»“")]),s._v(" "),t("p",[s._v("æœ¬æ–‡é¦–å…ˆè®²äº† "),t("code",[s._v("synchronized")]),s._v(" å’Œ "),t("code",[s._v("ReentrantLock")]),s._v(" çš„å®ç°è¿‡ç¨‹ï¼Œç„¶åè®²äº† "),t("code",[s._v("synchronized")]),s._v(" å’Œ "),t("code",[s._v("ReentrantLock")]),s._v(" çš„åŒºåˆ«ï¼Œæœ€åé€šè¿‡æºç çš„æ–¹å¼è®²äº† "),t("code",[s._v("ReentrantLock")]),s._v(" åŠ é”å’Œè§£é”çš„æ‰§è¡Œæµç¨‹ã€‚æ¥ç€åˆè®²äº† JDK 1.6 ä¸­çš„é”ä¼˜åŒ–ï¼ŒåŒ…æ‹¬è‡ªé€‚åº”å¼è‡ªæ—‹é”çš„å®ç°è¿‡ç¨‹ï¼Œä»¥åŠ "),t("code",[s._v("synchronized")]),s._v(" çš„ä¸‰ç§é”çŠ¶æ€å’Œé”å‡çº§çš„æ‰§è¡Œæµç¨‹ã€‚")]),s._v(" "),t("p",[t("code",[s._v("synchronized")]),s._v(" åˆšå¼€å§‹ä¸ºåå‘é”ï¼Œéšç€é”ç«äº‰è¶Šæ¥è¶Šæ¿€çƒˆï¼Œä¼šå‡çº§ä¸ºè½»é‡çº§é”å’Œé‡é‡çº§é”ã€‚å¦‚æœå¤§å¤šæ•°é”è¢«ä¸åŒçš„çº¿ç¨‹æ‰€äº‰æŠ¢å°±ä¸å»ºè®®ä½¿ç”¨åå‘é”äº†ã€‚")]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("æœ¬æ–‡é¦–å‘äºå¾®ä¿¡å…¬ä¼—å·ï¼šæ¶æ„å¸ˆæˆé•¿ä¹‹è·¯ï¼Œæ•´ç†æ”¶å½•äºä¸ªäººç«™ç‚¹ Java essay ,é˜…è¯»æ›´å¤šç²¾å½©æ–‡ç«  ğŸ‘‰ "),t("a",{attrs:{href:"https://javaessay.cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://javaessay.cn"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("è§‰å¾—æ–‡ç« ä¸é”™çš„æ¬¢è¿å…³æ³¨æˆ‘çš„WXå…¬ä¼—å·ï¼šæ¶æ„å¸ˆæˆé•¿ä¹‹è·¯")])])}),[],!1,null,null,null);t.default=e.exports}}]);